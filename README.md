# CVE Notification Bot (Telegram + NVD API)

ะขะตะปะตะณัะฐะผ-ะฑะพั, ะบะพัะพััะน ะฟะพะปััะฐะตั ะฝะพะฒัะต CVE ะธะท NVD API ะทะฐ ะทะฐะดะฐะฝะฝัะน ะฟะตัะธะพะด, ัะธะปััััะตั ะธั ะฟะพ **ะบะปััะตะฒัะผ ัะปะพะฒะฐะผ** ะธ ะพัะฟัะฐะฒะปัะตั ะฒ ัะฐั/ัะพะฟะธะบ.  
ะะพะดะดะตัะถะธะฒะฐะตั:
- ััะฐะฝะตะฝะธะต ัะตะบัะตัะพะฒ ะฒ `.env`;
- ะฒัะฑะพั ะฟะตัะธะพะดะฐ (30 ะผะธะฝัั / ัะฐั / ัััะบะธ / ะฝะตะดะตะปั / ะผะตััั);
- ะพัะฟัะฐะฒะบั ะฒ **ัะพััะผะฝัะต ัะพะฟะธะบะธ** (Telegram `message_thread_id`);
- ัััะพะณะธะน ะฟะพะธัะบ ะบะปััะตะฒัั ััะฐะท (ะฟะพ ัะปะพะฒะฐะผ/ััะฐะทะฐะผ ั ะณัะฐะฝะธัะฐะผะธ ะธ ะฟะพะดะดะตัะถะบะพะน ะฟัะพะฑะตะป/ะดะตัะธั), **ะฑะตะท ะผะฐััะตะน ะฒะฝัััะธ URL**;
- ัะพัะผะฐั ยซMore informationยป ัะพ ัะฟะธัะบะพะผ ัััะปะพะบ ะธะท `references`.

---

## ะขัะตะฑะพะฒะฐะฝะธั

- Python **3.10+**
- ะะพัััะฟ ะฒ ะธะฝัะตัะฝะตั ะบ:
  - `https://services.nvd.nist.gov/rest/json/cves/2.0`
  - `https://api.telegram.org/bot...`

## ะฃััะฐะฝะพะฒะบะฐ

```bash
git clone https://github.com/Toxich4/CVE_Telegram_Bot
cd CVE_Telegram_Bot

python3 -m venv .venv
. .venv/bin/activate
pip install -r requirements.txt
```

> ะะฐะฒะธัะธะผะพััะธ: `requests`, `python-dotenv`

---

## ะะพะฝัะธะณััะฐัะธั

### 1) `.env`

ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฒ ะบะพัะฝะต:

```dotenv
# Telegram
TELEGRAM_BOT_TOKEN=123456:ABCdef...
TELEGRAM_CHAT_ID=-100*********
# ะะปั ัะพััะผะฝะพะน ัะตะผั (ะพะฟัะธะพะฝะฐะปัะฝะพ)
# CHAT_ID = -100*********, THREAD_ID = 1
THREAD_ID=3461

# ะะตัะธะพะด ะฒัะณััะทะบะธ: 30m (ะฟะพ ัะผะพะปัะฐะฝะธั), hour, day, week, month
PERIOD=30m

# ะัะปะธ true โ ะธะณะฝะพัะธััะตะผ ะบะปััะตะฒัะต ัะปะพะฒะฐ ะธ ัะปัะผ ะฒัะต CVE
ALLOW_ALL=false

# ะััั ะบ ัะฐะนะปั ัะพ ัะฟะธัะบะพะผ ะบะปััะตะฒัั ัะปะพะฒ
KEYWORDS_FILE=keywords.txt
```

### 2) `keywords.txt`

ะคะฐะนะป ัะพ ัะฟะธัะบะพะผ ะบะปััะตะน/ััะฐะท (ะฟะพ ะพะดะฝะพะน ะฒ ัััะพะบะต). ะััััะต ัััะพะบะธ ะธ ัััะพะบะธ, ะฝะฐัะธะฝะฐััะธะตัั ั `#`, ะธะณะฝะพัะธัััััั. ะะฐะทัะตัะฐะตััั ะฝะตัะบะพะปัะบะพ ะทะฝะฐัะตะฝะธะน ัะตัะตะท ะทะฐะฟัััั ะฒ ะพะดะฝะพะน ัััะพะบะต.

ะัะธะผะตั:

```
# ะะตะฝะดะพัั/ะฟัะพะดัะบัั
Cisco
IOS XE
ASA
AnyConnect
Palo Alto
PAN-OS
Check Point
Citrix
Confluence
HashiCorp Vault
VMware
IIS
ESXi
vCenter
vSphere
Nexus
GitLab
Jenkins
Azure AD
Keycloak
Nginx
Grafana
Swagger
Kibana
Kubernetes
Nagios
Spring Boot
Next JS
MySQL
PostgreSQL
Redis
Airflow
Apache
Node.js
Vaadin
Laravel
```

---

## ะะฐะฟััะบ

### ะะฐะทะพะฒัะน ะทะฐะฟััะบ

```bash
. .venv/bin/activate
python3 cve_bot.py
```

ะ ะปะพะณะฐั ัะฒะธะดะธัะต:
- ะฒัะฑัะฐะฝะฝัะน ะฟะตัะธะพะด / allow_all / ะฟััั ะบ `keywords.txt`;
- ัะพัะฝัะน URL, ะบะพัะพััะน ัััะป ะฒ NVD (ัะดะพะฑะฝะพ ะดะปั ะพัะปะฐะดะบะธ);
- ะบะพะปะธัะตััะฒะพ ะฟะพะปััะตะฝะฝัั CVE;
- ัััะพะบะธ ะฒะธะดะฐ `[MATCH] CVE-XXXX-YYYY by 'Azure AD'` โ ะฟะพะบะฐะทัะฒะฐัั, ะฟะพ ะบะฐะบะพะผั ะบะปััั ะฟัะพัะปะพ.

### ะะตัะธะพะดะธัะตัะบะธะน ะทะฐะฟััะบ (cron)

ะะฐะดัะถะฝัะน ะฟัะธะผะตั:

```cron
*/30 * * * * python3 cve_bot.py >> bot.log 2>&1'
```

### ะัะฟัะฐะฒะบะฐ ะฒ ะบะพะฝะบัะตัะฝัะน ัะพะฟะธะบ (ัะพััะผ)

- `TELEGRAM_CHAT_ID` โ `-100` + ะฒะฝัััะตะฝะฝะธะน id ะธะท ัััะปะบะธ (`https://t.me/c/<id>/<topic>/<msg>`).
- `THREAD_ID` โ ััะตะดะฝะธะน ัะตะณะผะตะฝั `<topic>`.

ะัะธะผะตั:

```
https://t.me/c/2461133703/5
CHAT_ID = -1002461133703
THREAD_ID = 5
```

---

## ะคะพัะผะฐั ัะพะพะฑัะตะฝะธั

```
๐จ  CVE-2025-12345 (https://nvd.nist.gov/vuln/detail/CVE-2025-12345) ๐จ
๐ฅ  CVSS: 9.8
๐  Published: 2025-10-03
๐  Description: <ะฐะฝะณะป. ะพะฟะธัะฐะฝะธะต CVE>
โน๏ธ  More information:
1. <url>
2. <url>
```
