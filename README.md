# CVE Notification Bot (Telegram + NVD API)

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ CVE –∏–∑ NVD API –∑–∞ –∑–∞–¥–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏—Ö –ø–æ **–∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º** –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ —á–∞—Ç/—Ç–æ–ø–∏–∫.  
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ `.env`;
- –≤—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ (30 –º–∏–Ω—É—Ç / —á–∞—Å / —Å—É—Ç–∫–∏ / –Ω–µ–¥–µ–ª—è / –º–µ—Å—è—Ü);
- –æ—Ç–ø—Ä–∞–≤–∫—É –≤ **—Ñ–æ—Ä—É–º–Ω—ã–µ —Ç–æ–ø–∏–∫–∏** (Telegram `message_thread_id`);
- —Å—Ç—Ä–æ–≥–∏–π –ø–æ–∏—Å–∫ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑ (–ø–æ —Å–ª–æ–≤–∞–º/—Ñ—Ä–∞–∑–∞–º —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø—Ä–æ–±–µ–ª/–¥–µ—Ñ–∏—Å), **–±–µ–∑ –º–∞—Ç—á–µ–π –≤–Ω—É—Ç—Ä–∏ URL**;
- —Ñ–æ—Ä–º–∞—Ç ¬´More information¬ª —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Å—ã–ª–æ–∫ –∏–∑ `references`.

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python **3.10+**
- –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∫:
  - `https://services.nvd.nist.gov/rest/json/cves/2.0`
  - `https://api.telegram.org/bot...`

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone <your-repo-url>
cd <repo-dir>

python3 -m venv .venv
. .venv/bin/activate
pip install -r requirements.txt
```

> –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `requests`, `python-dotenv`

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### 1) `.env` (–Ω–µ –∫–æ–º–º–∏—Ç–∏–º, –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`)

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ:

```dotenv
# Telegram
TELEGRAM_BOT_TOKEN=123456:ABCdef...
TELEGRAM_CHAT_ID=-100*********
# –î–ª—è —Ñ–æ—Ä—É–º–Ω–æ–π —Ç–µ–º—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# CHAT_ID = -100*********, THREAD_ID = 1
THREAD_ID=3461

# –ü–µ—Ä–∏–æ–¥ –≤—ã–≥—Ä—É–∑–∫–∏: 30m (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), hour, day, week, month
PERIOD=30m

# –ï—Å–ª–∏ true ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏ —à–ª—ë–º –≤—Å–µ CVE
ALLOW_ALL=false

# –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
KEYWORDS_FILE=keywords.txt
```

### 2) `keywords.txt`

–§–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–ª—é—á–µ–π/—Ñ—Ä–∞–∑ (–ø–æ –æ–¥–Ω–æ–π –≤ —Å—Ç—Ä–æ–∫–µ). –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç—Ä–æ–∫–∏, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å `#`, –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è. –†–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ.

–ü—Ä–∏–º–µ—Ä:

```
# –í–µ–Ω–¥–æ—Ä—ã/–ø—Ä–æ–¥—É–∫—Ç—ã
Cisco
IOS XE
ASA
AnyConnect
Palo Alto
PAN-OS
Check Point
Citrix
Confluence
HashiCorp Vault
VMware
IIS
ESXi
vCenter
vSphere
Nexus
GitLab
Jenkins
Azure AD
Keycloak
Nginx
Grafana
Swagger
Kibana
Kubernetes
Nagios
Spring Boot
Next JS
MySQL
PostgreSQL
Redis
Airflow
Apache
Node.js
Vaadin
Laravel
```

---

## –ó–∞–ø—É—Å–∫

### –†–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
. .venv/bin/activate
python cve_bot.py
```

–í –ª–æ–≥–∞—Ö —É–≤–∏–¥–∏—Ç–µ:
- –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ / allow_all / –ø—É—Ç—å –∫ `keywords.txt`;
- —Ç–æ—á–Ω—ã–π URL, –∫–æ—Ç–æ—Ä—ã–π —É—à—ë–ª –≤ NVD (—É–¥–æ–±–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏);
- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö CVE;
- —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∞ `[MATCH] CVE-XXXX-YYYY by 'Azure AD'` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –ø–æ –∫–∞–∫–æ–º—É –∫–ª—é—á—É –ø—Ä–æ—à–ª–æ.

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (cron)

–ù–∞–¥—ë–∂–Ω—ã–π –ø—Ä–∏–º–µ—Ä:

```cron
*/30 * * * * python3 cve_bot.py >> bot.log 2>&1'
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–ø–∏–∫ (—Ñ–æ—Ä—É–º)

- `TELEGRAM_CHAT_ID` ‚Äî `-100` + –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π id –∏–∑ —Å—Å—ã–ª–∫–∏ (`https://t.me/c/<id>/<topic>/<msg>`).
- `THREAD_ID` ‚Äî —Å—Ä–µ–¥–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç `<topic>`.

–ü—Ä–∏–º–µ—Ä:

```
https://t.me/c/2461133703/5
CHAT_ID = -1002461133703
THREAD_ID = 5
```

---

## –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

```
üö®  CVE-2025-12345 (https://nvd.nist.gov/vuln/detail/CVE-2025-12345) üö®
üí•  CVSS: 9.8
üìÖ  Published: 2025-10-03
üìì  Description: <–∞–Ω–≥–ª. –æ–ø–∏—Å–∞–Ω–∏–µ CVE>
‚ÑπÔ∏è  More information:
1. <url>
2. <url>
...
```
